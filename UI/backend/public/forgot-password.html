<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SmartClub - Quên mật khẩu</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Language Switcher -->
  <div class="language-switcher">
    <button id="btnLangVI" class="active" onclick="switchLanguage('vi')">VI</button>
    <button id="btnLangEN" onclick="switchLanguage('en')">EN</button>
  </div>

  <div class="container">
    <div class="card">
      <img src="images/logo.png" alt="SmartClub" class="logo" onerror="this.style.display='none'">
      <h2>QUÊN MẬT KHẨU</h2>
      
      <div id="step1" class="step-content active">
        <p>Nhập email hoặc số điện thoại của bạn</p>
        <input type="text" id="emailOrPhone" placeholder="Email hoặc số điện thoại..." maxlength="50">
        <button id="btnRequest" onclick="requestPasswordReset()">Gửi mã xác nhận</button>
        <p class="error" id="error1"></p>
        <p class="success" id="success1" style="display: none;"></p>
      </div>

      <div id="step2" class="step-content" style="display: none;">
        <p>Nhập mã xác nhận đã được gửi đến <span id="contactInfo"></span></p>
        <input type="text" id="verificationCode" placeholder="Nhập mã 6 số..." maxlength="6" pattern="[0-9]*">
        <button id="btnVerify" onclick="verifyCode()">Xác nhận</button>
        <button id="btnBack1" onclick="goToStep(1)" style="background: #999; margin-top: 10px;">Quay lại</button>
        <p class="error" id="error2"></p>
      </div>

      <div id="step3" class="step-content" style="display: none;">
        <h3 style="color: #1976d2; margin-bottom: 20px;">Đặt lại mật khẩu</h3>
        <p>Nhập mật khẩu mới của bạn</p>
        <input type="password" id="newPassword" placeholder="Mật khẩu mới..." maxlength="100">
        <input type="password" id="confirmPassword" placeholder="Xác nhận mật khẩu..." maxlength="100" style="margin-top: 10px;">
        <button id="btnReset" onclick="resetPassword()" style="margin-top: 15px;">Đặt lại mật khẩu</button>
        <button id="btnBack2" onclick="goToStep(2)" style="background: #999; margin-top: 10px;">Quay lại</button>
        <p class="error" id="error3"></p>
      </div>

      <div id="step4" class="step-content" style="display: none;">
        <h3 style="color: #4caf50; margin-bottom: 20px;">Đặt lại mật khẩu thành công!</h3>
        <p>Mật khẩu của bạn đã được đặt lại thành công. Vui lòng đăng nhập lại.</p>
        <button onclick="window.location.href='index.html'" style="background: #1976d2; margin-top: 20px;">Đăng nhập</button>
      </div>

      <p style="margin-top: 20px; font-size: 14px;">
        <a href="index.html" style="color: #1976d2; text-decoration: none;">← Quay lại đăng nhập</a>
      </p>
    </div>
  </div>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="js/i18n.js"></script>
  <script src="js/api.js"></script>
  <script src="js/forgotPassword.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      initLanguageSwitcher();
      translatePage();
    });

    function initLanguageSwitcher() {
      const currentLang = window.i18n ? window.i18n.getLanguage() : 'vi';
      updateLanguageButtons(currentLang);
    }

    function switchLanguage(lang) {
      if (window.i18n) {
        window.i18n.setLanguage(lang);
        updateLanguageButtons(lang);
        translatePage();
      }
    }
    
    function translatePage() {
      if (window.i18n) {
        window.i18n.translatePage();
      }
    }

    function updateLanguageButtons(lang) {
      const btnVI = document.getElementById('btnLangVI');
      const btnEN = document.getElementById('btnLangEN');
      if (btnVI && btnEN) {
        if (lang === 'vi') {
          btnVI.classList.add('active');
          btnEN.classList.remove('active');
        } else {
          btnVI.classList.remove('active');
          btnEN.classList.add('active');
        }
      }
    }
  </script>
</body>
</html>

